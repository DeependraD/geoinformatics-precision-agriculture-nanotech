---
title: "Remote sensing: concepts and applications; Image processing and interpretation"
author: |
  | Deependra Dhakal
  | Assistant Professor
  | \textit{ddhakal.rookie@gmail.com}
  | \url{https://rookie.rbind.io}
output: 
  binb::monash:
    toc: true
    keep_tex: true
    slide_level: 2
    includes:
      in_header: beamer_header_template.tex
colortheme: monashwhite
outertheme: smoothtree
innertheme: rounded
innercolortheme: rose
outercolortheme: whale
linkcolor: red
urlcolor: blue
# titlefontsize: 22pt # breaks custom \lineskip
titlepage: daffodil_seeds.jpg
fontsize: 10pt
classoption: "aspectratio=169" # "compressed"
bibliography: [./../bibliographies.bib]
header-includes: 
  - \AtBeginSubsection{}
---

```{r setup, include=FALSE}
library(knitr)
require(tidyverse)
set.seed(453)
# invalidate cache when the package version changes
knitr::opts_chunk$set(tidy = FALSE, echo = FALSE, 
                  message = FALSE, warning = FALSE,
                  out.width = "45%", cache = TRUE, 
                  dev.args=list(bg=grey(0.9), pointsize=11))
options(knitr.table.format = "latex")
options(knitr.kable.NA = "", digits = 2)
options(kableExtra.latex.load_packages = FALSE)
theme_set(theme_bw())
```

# Remote sensing

## Background

\begin{columns}[T, onlytextwidth]
\column{0.6\textwidth}

\begin{itemize}
\item History may be traced back to the first pre-historic explorer who climbed a nearby hill to study the lay of the land.
\item During first half of 19th century, Louis Jacques Mande Daguerre and Joseph Nicephore Niepc invented a photographic device, a foundation for modern photography and a means to record a remotely sensed image.
\item In 1859, Gaspard Félix Tournachon Clateu (later known in the literature as Félix Nadar) took the first known aerial image from a balloon.
\end{itemize}
\column{0.4\textwidth}

```{r historical-landsat, fig.cap="Landsat MSS image acquired September 20, 1984 over the Nile Delta area.", out.width="88%"}
knitr::include_graphics("../images/landsat_mss_september20_1984_nile_delta.png")
```

\end{columns}

## Meaning

- Remote sensing provides data at a synoptic\footnote[frame]{Pertaining to or affording an overall view; referring to the use of meteorological data obtained simultaneously over a wide area for the purpose of presenting a comprehensive and nearly instantaneous picture of the state of the atmosphere} global level that is impossible to replicate with in situ measurements.
- As developments in novel image processing algorithms and community around use and communication of image data continue, scientific value of remotely sensed data grow to the extent that never anticipated information are extracted.
- However, there are tradeoffs between the local detail of the measurements (radiometric resolution, number of spectral bands) and the spatial scale of the area being measured.
- Remote sensing is a more rapid means to sample multiple crop parameters from spectral indices such as NDVI.
  - Productive canopy surface (LAI)
  - Productivity and yield potential
  - Photosynthetic capacity

## Landsat imagery

- 2022 marks 50th anniversary of the continuous planetary land coverage gathered by the Landsat imaging system.
- Instruments on the Landsat satellites have acquired millions of images and can be viewed through the U.S. Geological Survey (USGS) "EarthExplorer" \footnote[frame]{https://earthexplorer.usgs.gov/} website. 
- Current version of the landsat (Landsat-9) was launched in September 27, 2021
- Currently Landsat program is managed jointly by:
  - NASA
  - USGS
- Landsat 7 data has eight spectral bands with spatial resolutions ranging from 15 to 60 m (49 to 197 ft); the temporal resolution is 16 days.
- Landsat images are usually divided into scenes for easy downloading. Each Landsat scene is about 115 miles long and 115 miles wide (or 185 kilometers long and 185 kilometers wide).
- Landsat imagery is coarse in spatial resolution compared to using other remote sensing methods, such as imagery from airplanes.

## Applications of Landsat imagery

- Agriculture risk management
- Government mapping
- Agricultural water use monitoring
- Global security monitoring
- Support for fire management
- Detection of forest fragmentation
- Detection of forest change
- World agriculture supply and demand estimates
- Vineyard management and water conservation
- Flood mitigation mapping
- Agricultural commodities mapping
- Waterfowl habitat mapping and monitoring
- Coastal change analysis
- Forest health monitoring
- Wildfire risk assessment
- Fisheries, forestry, shrinking inland water bodies, fire damage, glacier retreat, urban development, and discovery of new species

##

```{r}
require(rvest)
landsat_wiki <- read_html(url("https://en.wikipedia.org/wiki/Landsat_program"))

landsat_wiki_tables <- landsat_wiki %>% 
  html_elements("table")

# landsat_wiki_tables[[4]] %>% 
#   html_table() %>% 
#   write_csv("../data/landsat7_etm_plus_spatial_spectral_resolution.csv", "")

# landsat_wiki_tables[[5]] %>%
#   html_table() %>%
#   write_csv("../data/landsat8_oli_tirs_spatial_spectral_resolution.csv", "")

read_csv("../data/landsat8_oli_tirs_spatial_spectral_resolution.csv", show_col_types = FALSE) %>% 
  knitr::kable(booktabs = TRUE, caption = "Landsat 8 Operational Land Imager (OLI) and Thermal Infrared Sensor (TIRS). TIRS bands are acquired at 100 meter resolution, but are resampled to 30 meter in delivered data product") %>% 
  kableExtra::kable_styling(font_size = 8) %>% 
  kableExtra::column_spec(column = 1:3, width = c("14em", "10em", "10em"))
```

##

```{r band-comparison-lansat89-landsatnext, fig.cap="Source: \\url{https://upload.wikimedia.org/wikipedia/commons/8/88/L8and9-to-LandsatNext-BandComparison.png}", out.width="65%"}
knitr::include_graphics("../images/L8and9-to-LandsatNext-BandComparison.png")
```

# Acquiring remotely sensed data

## Landsat Missions of USGS

\begin{columns}[T, onlytextwidth]

\column{0.5\textwidth}

```{r usgs-portal, fig.align="center", out.width="98%"}

# pdftools::pdf_convert("../../geoinformatics-pages/Landsat 8 _ U.S. Geological Survey.pdf",
#                       pages = 1:2,
#                       filenames = paste0("../images/usgs_official_portal_p", 1:2, ".png"), 
#                       format = "png", dpi = 250)
knitr::include_graphics("../images/usgs_official_portal_p1.png")
```

\column{0.5\textwidth}


```{r earthexplorer-portal, fig.align="center", out.width="98%"}

knitr::include_graphics("../images/usgs_landsat_mapping_earth_explorer.png")
```

\end{columns}

## Sentinel mission of NASA

```{r sentinel-nasa-portal, fig.align="center", out.width="85%"}
knitr::include_graphics("../images/earthdata_nasa_sentinel_data_viewer.png")
```

# Image processing

## Preprocessing 

- To remove noise and increase the interpretability of image data (essential when a time series of imagery is used or when when multiple image operation such as join is required to account for an area encompassed by many images to make these images compatible spatially and spectrally)
- All images after image preprocessing should appear as if they were acquired from the same sensor (Hall et al. 1991).
- Image processing sensors are usually categorized into levels (0, 1A, 1B, 2A, 2B, 3A, 3B with image quality gradually increased). For example, for most sensors, level 3A means that radiometric correction, geometric correction and orthorectification have been processed for the images.
- Factors such as seasonal phenology, ground conditions and atmospheric conditions can contribute to variability in multi-temporal spectral responses that may have little to do with the remote sensed objects themselves (Song and Woodcock 2003)

##

- Image preprocessing commonly comprises a series of operations,
  - including but not limited to bad lines replacement,
  - radiometric correction,
  - geometric correction,
  - image enhancement and masking (e.g. for clouds, water, irrelevant features) although variations may exist for images acquired by different sensors.
  - bad line replacement (fills in missing lines with the line above, below or with an average of the two) to determine the overall quality of the images (e.g. missing data lines) through visually previewing the images band-by-band
  - cloud imposes a big noise in mapping vegetation cover for identifying and thus has to be removed or masked.
    - neural network to detect cloud in SPOT VEGETATION images
    - cloud-free space shuttle photograph to detect and remove (mask) unwanted cloud covers in Landsat TM scenes  

## Image pre-processing: Radiometric correction

- radiometric correction normally involves the process of correcting radiometric errors or distortions of digital images to improve the fidelity of the brightness values. radiometric correction methods (absolute and relative correction):
  - complex mathematical models that describe the main interactions involved (certain parameters (i.e. the atmospheric composition) must be known before applying them). 
  - methods based on the observations of reference targets (e.g. water or desert land) whose radiometry is known.

## Image pre-processing: Geometric correction

- geometric correction to avoid geometric distortions from a distorted image and is achieved by establishing the relationship between the image coordinate system and the geographic coordinate system using the calibration data of the sensor, the measured data of position and altitude and the ground control points

\begin{columns}[T, onlytextwidth]
\column{0.5\textwidth}

```{r geometric-fault-example, fig.align='center', out.width="70%"}
# magick library is well documented at: https://www.imagemagick.org/Magick++/Documentation.html
checkerboard <- magick::image_read("../images/irrigating_farmer.png")
# checkerboard %>% 
#   magick::image_attributes()

checkerboard <- checkerboard %>% 
  magick::image_resize(filter = "Cubic", geometry = "500x") # refer to filter_types() for options

checkerboard
```

\column{0.5\textwidth}

```{r geometric-fault-example-correct, fig.align='center', out.width="70%"}

# checkerboard %>% 
  # magick::image_convert(matte = FALSE) # matte false disables transparency


checkerboard %>% 
    magick::image_distort(distortion = "Affine",
                          coordinates = c(30, 40, 40, 25,
                                          70, 240, 20, 180),
                          bestfit = FALSE)

# first_coord <- seq(0, 50, by = 5)
# second_coord <- first_coord
# 
# checkerboard_dist_frames <- map2(.x = first_coord, .y = second_coord,
#      .f = ~magick::image_distort(checkerboard, distortion = "Affine",
#                                  coordinates = c(0, 0, .x, .y))) 

# # checkerboard_dist_frames can only be converted or used in `magick` when used as single or multiple vector element for example following WORKS with any modification:
# c(checkerboard_dist_frames[[1]],
#   checkerboard_dist_frames[[2]],
#   checkerboard_dist_frames[[3]])
  
# magick::image_write_video("../images/checkerboard_distort_movie.mp4", framerate = 20)
  
```

\end{columns}

## Image pre-processing: Image enhancement

- image enhancement is aimed to emphasize and sharpen particular image features (i.e. particular species of vegetation) for visualization purpose
  - gray scale conversion,
  - histogram conversion,
  - color composition,
  - color conversion between red-green-blue (RGB), and
  - hue–saturation–intensity transform (HSI), etc.

# Bibliography

## References
